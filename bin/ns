#!/usr/bin/env ruby
# notes sync script

require 'dotenv/load'
Dotenv.load(File.join(File.dirname(__FILE__), '.env'))

$notes_path = File.expand_path('~/code/notes')

unless system('curl -s --connect-timeout 2 --max-time 3 http://example.com > /dev/null 2>&1')
  puts "No internet connection"
  exit
end

Dir.chdir($notes_path) do
  system('git add .')

  commit_message = "Update notes - #{Time.now.strftime('%Y-%m-%d %H:%M:%S')}"
  system("git commit -m '#{commit_message}'")

  system('git pull --rebase')

  system('git push')
end
